<<define "game">>
  <<template "header" .>>

<<if .TeamID>>
    <div class="row">
      <div class="col-lg-6 col-centered">
        <div class="alert alert-info" role="alert">
          Team was created successfully! Use this link to invite your friends: <a href="http://teamneuron.mybluemix.net/<< .TeamID>>">http://teamneuron.mybluemix.net/<< .TeamID>></a>
        </div>
      </div>
    </div>
<<end>>     
<div class="container">
    <div class="row">
      <p>TIMER</p>
    </div>

    <div class="row">
      <table style="width:100%">
        <tr>
          <td style="width:25%">
            <div id="player-1" class="player-1">Player 1</div>
          </td>
          <td style="width:50%">
            <div id="game-field">Please wait for second player</div>
          </td>
          <td style="width:25%">
          <div id="player-2" class="player-2"/>Player 2</div>
          </td>
        </tr>
      </table>
    </div>

    <div class="row">
      <p>TOTAL SCORE</p>
    </div>

</div>


<script src="/static/lib/socket.io/socket.io-1.3.6.js"></script>
<script src="/static/lib/jquery/jquery.min.js"></script>
<script src="/static/lib/jquery-ui/js/jquery-ui.min.js"></script>
<script type="text/javascript">
$("#game-field").ready(function() {
      var lid = window.location.pathname.lastIndexOf("/")
      var teamId = window.location.pathname.substring(lid+1)

      var socket = io.connect(window.location.host + "?team_id="+teamId);
      var playerIndex = 0;
      var $playField = $('#game-field');

      socket.on('connected', function (data) {
        playerIndex = parseInt(data);

        console.log('connected: ' + playerIndex);
        $elem = $("#player-" + playerIndex);
        $elem.html("this is you");
      });  

      socket.on('task_received', function (data) {
        console.log('task_received: ' + data);
        $playField.html(data);
      });  

      socket.on('error', function (data) {
        console.log('error: ' + data);

        $("#dialog-confirm").html(data)

        $("#dialog-confirm").dialog({
            resizable: false,
            modal: true,
            title: "Error occurred",
            height: 250,
            width: 400,
            buttons: {
                "OK": function () {
                    window.location="/"
                }
            }
        });
      });        
})
</script>

<div id="dialog-confirm"></div>

  <<template "footer" .>>
<<end>>
